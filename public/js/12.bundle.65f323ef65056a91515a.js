(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{938:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c}));var a=n(22),r=Object(a.a)((function(){return n.e(6).then(n.bind(null,940))})),o=Object(a.a)((function(){return Promise.all([n.e(1),n.e(7)]).then(n.bind(null,941))})),l=Object(a.a)((function(){return n.e(38).then(n.bind(null,942))})),c=Object(a.a)((function(){return Promise.all([n.e(0),n.e(22)]).then(n.bind(null,943))}))},959:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(22),r=(Object(a.a)((function(){return Promise.all([n.e(0),n.e(21)]).then(n.bind(null,965))})),Object(a.a)((function(){return Promise.all([n.e(0),n.e(39)]).then(n.bind(null,966))}))),o=Object(a.a)((function(){return Promise.all([n.e(0),n.e(40)]).then(n.bind(null,967))}))},981:function(e,t,n){"use strict";n.r(t);var a=n(46),r=n.n(a),o=n(4),l=n.n(o),c=n(5),u=n.n(c),i=n(9),s=n.n(i),m=n(35),p=n.n(m),d=n(54),f=n.n(d),b=n(31),E=n.n(b),h=n(0),g=n.n(h),y=n(21),x=n(28),v=n(206),O=n.n(v),w=n(207),N=n.n(w),j=n(149),_=n.n(j),C=n(209),k=n.n(C),D=n(105),P=n(944),S=n(203),T=n(938),F=n(58),z=n.n(F),W=n(50),q=n.n(W),B=n(873),I=n.n(B),R=n(893),M=n(894),$=n(895),H=n(896),J=n(897),A=n(898),G=n(959);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=Object(x.withStyles)((function(e){var t;return{pageContentWrapper:{width:"100%",marginTop:3*e.spacing.unit,minHeight:"75vh",overflowX:"auto"},table:{margin:"8px 0"},cell:{padding:"8px 4px"},cell_subtotal:{padding:"8px 4px !important",display:"flex",flexDirection:"column",textAlign:"center",fontSize:e.typography.pxToRem(14)},pageContent:{padding:3*e.spacing.unit},panelDetails:{flexDirection:"column",padding:"8px 4px"},panelDetailsRow:(t={flexDirection:"column"},s()(t,e.breakpoints.up("md"),{flexDirection:"row"}),s()(t,"padding","8px 4px"),t),selectNative:{display:"block"},gridButtonsFooter:{margin:"8px",width:"auto",alignItems:"center"},ButtonsOrder:{width:"100%"},panelTotal:{backgroundColor:"rgb(9 202 0 / 12%)",opacity:"unset !important"},root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(18),flexBasis:"90%",flexShrink:0,fontWeight:500,marginLeft:"8px"},headingTotal:{fontSize:e.typography.pxToRem(18),fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}}))((function(e){var t=e.history,n=Object(h.useState)(!1),a=E()(n,2),o=a[0],c=a[1],i=Object(h.useState)([]),m=E()(i,2),d=(m[0],m[1],Object(h.useState)({})),b=E()(d,2),x=b[0],v=b[1],w=Object(h.useState)("customer"),j=E()(w,2),C=j[0],F=j[1],W=Object(h.useState)(16431),B=E()(W,2),L=B[0],X=(B[1],Object(h.useState)(null)),K=E()(X,2),Q=K[0],V=K[1],Y=Object(h.useState)([]),Z=E()(Y,2),ee=Z[0],te=Z[1],ne=Object(h.useState)({total_bruto:0,total:0,delivery_cost:"",discount:"",payment_method:""}),ae=E()(ne,2),re=ae[0],oe=ae[1];Object(h.useEffect)((function(){}),[]),Object(h.useEffect)((function(){Q&&(0==ee.length?le(!1):le())}),[re.total_bruto]),Object(h.useEffect)((function(){Q&&le(!1)}),[re.discount]),Object(h.useEffect)((function(){"ef"==re.payment_method&&"p"==Q.type&&oe((function(e){return U({},e,{discount:10})}))}),[re.payment_method]);var le=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=re.total_bruto,n=re.delivery_cost;parseFloat(re.discount)&&(t-=re.discount*t/100),e&&(n=t<1500&&"p"==Q.type?150:0,t+=n),t!=re.total&&oe((function(e){return U({},e,{total:Number(t.toFixed(2)),delivery_cost:n})}))},ce=function(e){return function(t,n){Q?F(!!n&&e):v({type:"error",body:"Debe elegir un cliente primero",closed:function(){return v({})}})}},ue=function(e){V(e),F("items")},ie=function(e,t){oe((function(n){return U({},n,s()({},e.name,"number"==t?Number(e.value):e.value))}))},se=e.classes,me=u()(e,["classes"]),pe=function(){var e=f()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee[t].id,e.next=3,P.e.delete(n);case 3:e.sent,oe((function(e){return U({},e,{total_bruto:Number((parseFloat(e.total_bruto)-parseFloat(ee[t].price_final)).toFixed(2))})})),v({type:"success",body:'"'+ee[t].name+'" eliminado',closed:function(){return v({})}}),te((function(e){return e.splice(t,1),r()(e)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=f()(p.a.mark((function e(t){var n,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=U({},t)).id_order=L,e.next=4,P.e.store(n);case 4:a=e.sent,o=U({},t,{},a),te((function(e){return e.push(o),r()(e)})),oe((function(e){return U({},e,{total_bruto:Number((parseFloat(e.total_bruto)+parseFloat(a.price_final)).toFixed(2))})})),v({type:"success",body:'"'+t.name+'" agregado',closed:function(){return v({})}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=f()(p.a.mark((function e(){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,(n=U({},re)).id_customer=Q.id,e.next=6,P.d.update(L,U({},n));case 6:a=e.sent,v({type:"success",body:'Orden "'+a.id+'" creada con éxito',closed:function(){return v({})}}),c(!1),t.push(D.a("backoffice.general.orders.index")),e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(1),console.log(e.t0),e.t0.response){e.next=17;break}throw new Error("Unknown error");case 17:r=e.t0.response.data.errors,setErrors(r),c(!1);case 20:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return g.a.createElement(T.b,l()({},me,{pageTitle:"Nuevo Pedido # ".concat(L),tabs:[],message:x,showBreadcrumbs:!1}),g.a.createElement("div",{className:se.pageContentWrapper},o&&g.a.createElement(S.b,null),g.a.createElement(y.p,{expanded:"customer"===C,onChange:ce("customer")},g.a.createElement(y.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(M.a,null),g.a.createElement(y.lb,{className:se.heading},Q?Q.name:"Cliente")),g.a.createElement(y.q,{className:se.panelDetails},g.a.createElement(G.a,l()({},me,{customer:Q,setCustomer:ue})))),g.a.createElement(y.p,{expanded:"items"===C,onChange:ce("items")},g.a.createElement(y.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement($.a,null),g.a.createElement(y.lb,{className:se.heading},"Productos ($",re.total_bruto?re.total_bruto:"0.00",")")),g.a.createElement(y.q,{className:se.panelDetails},g.a.createElement(O.a,{className:se.table},g.a.createElement(N.a,null,ee.map((function(e,t){return g.a.createElement(k.a,{key:e.quantity},g.a.createElement(_.a,{scope:"row",className:se.cell},e.name," ",g.a.createElement("br",null),e.quantity," x ",e.price_unit," ",g.a.createElement("br",null),e.discount," %"),g.a.createElement(_.a,{className:se.cell_subtotal},g.a.createElement(q.a,{className:se.button,"aria-label":"Delete",onClick:function(){return pe(t)}},g.a.createElement(I.a,null)),g.a.createElement("b",null,"$ ",e.price_final)))})))),g.a.createElement(G.b,l()({typePrice:Q?Q.type:"m",total:re.total,addItemsToOrder:de},me)))),g.a.createElement(y.p,{expanded:"extras"===C,onChange:ce("extras")},g.a.createElement(y.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(H.a,null),g.a.createElement(y.lb,{className:se.heading},"Extras")),g.a.createElement(y.q,{className:se.panelDetailsRow},g.a.createElement(y.u,{item:!0,xs:12,sm:4},g.a.createElement(y.C,{shrink:!0,htmlFor:"payment_method"},"Método de pago"),g.a.createElement(y.M,{onChange:function(e){return ie(e.target,"text")},className:se.selectNative,value:re.payment_method,input:g.a.createElement(y.z,{name:"payment_method"})},g.a.createElement("option",{value:""},"No definido"),g.a.createElement("option",{value:"ef"},"Efectivo"),g.a.createElement("option",{value:"trans"},"Transferencia"),g.a.createElement("option",{value:"mp"},"Mercado Pago"))),g.a.createElement(y.u,{item:!0,xs:12,sm:4},g.a.createElement(y.C,{htmlFor:"discount"},"Descuento %"," ",g.a.createElement("span",null)),g.a.createElement(y.z,{name:"discount",type:"number",min:1,step:1,max:100,value:re.discount,onChange:function(e){return ie(e.target,"number")},fullWidth:!0})),g.a.createElement(y.u,{item:!0,xs:12,sm:4},g.a.createElement(y.C,{htmlFor:"delivery_cost"},"Costo de envío",g.a.createElement("span",null)),g.a.createElement(y.z,{name:"delivery_cost",type:"number",value:re.delivery_cost,onChange:function(e){return t=e.target,oe((function(e){return U({},e,s()({},t.name,Number(t.value)))})),void le(!1);var t},fullWidth:!0})))),g.a.createElement(y.p,{expanded:"comments"===C,onChange:ce("comments")},g.a.createElement(y.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(J.a,null),g.a.createElement(y.lb,{className:se.heading},"Notas del pedido")),g.a.createElement(y.q,{className:se.panelDetails},g.a.createElement(y.u,{item:!0,xs:12,sm:12},g.a.createElement(y.ib,{name:"notes",onChange:function(e){return ie(e.target,"text")},label:"Notas",multiline:!0,fullWidth:!0,variant:"outlined",rowsMax:8})))),g.a.createElement(y.p,{disabled:!0,className:se.panelTotal},g.a.createElement(y.r,{className:se.panelTotal},g.a.createElement(A.a,null),g.a.createElement(y.lb,{className:se.headingTotal},"Total pedido: $",re.total))),g.a.createElement(y.u,{container:!0,className:se.gridButtonsFooter,spacing:24},g.a.createElement(y.u,{item:!0,xs:12},g.a.createElement(z.a,{className:se.ButtonsOrder,variant:"contained",color:"primary",disabled:!(re.total>0),onClick:function(){return fe()}},"Guardar")))))}))}}]);