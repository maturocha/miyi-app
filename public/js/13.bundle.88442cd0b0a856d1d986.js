(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{938:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));var a=n(22),r=Object(a.a)((function(){return n.e(6).then(n.bind(null,940))})),o=Object(a.a)((function(){return Promise.all([n.e(1),n.e(7)]).then(n.bind(null,941))})),c=Object(a.a)((function(){return n.e(38).then(n.bind(null,942))})),l=Object(a.a)((function(){return Promise.all([n.e(0),n.e(22)]).then(n.bind(null,943))}))},959:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(22),r=(Object(a.a)((function(){return Promise.all([n.e(0),n.e(21)]).then(n.bind(null,965))})),Object(a.a)((function(){return Promise.all([n.e(0),n.e(39)]).then(n.bind(null,966))}))),o=Object(a.a)((function(){return Promise.all([n.e(0),n.e(40)]).then(n.bind(null,967))}))},982:function(e,t,n){"use strict";n.r(t);var a=n(46),r=n.n(a),o=n(4),c=n.n(o),l=n(5),i=n.n(l),u=n(9),s=n.n(u),m=n(35),p=n.n(m),d=n(54),f=n.n(d),b=n(31),h=n.n(b),E=n(0),g=n.n(E),x=n(21),y=n(28),v=n(206),O=n.n(v),w=n(207),_=n.n(w),j=n(149),N=n.n(j),k=n(209),C=n.n(k),D=n(61),P=n(105),S=n(944),T=n(203),F=n(938),z=n(58),W=n.n(z),B=n(50),I=n.n(B),R=n(873),q=n.n(R),M=n(893),$=n(894),H=n(895),J=n(896),A=n(897),G=n(898),L=n(959);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=Object(y.withStyles)((function(e){var t;return{pageContentWrapper:{width:"100%",marginTop:3*e.spacing.unit,minHeight:"75vh",overflowX:"auto"},table:{margin:"8px 0"},cell:{padding:"8px 4px"},cell_subtotal:{padding:"8px 4px !important",display:"flex",flexDirection:"column",textAlign:"center",fontSize:e.typography.pxToRem(14)},pageContent:{padding:3*e.spacing.unit},panelDetails:{flexDirection:"column",padding:"8px 4px"},panelDetailsRow:(t={flexDirection:"column"},s()(t,e.breakpoints.up("md"),{flexDirection:"row"}),s()(t,"padding","8px 4px"),t),selectNative:{display:"block"},gridButtonsFooter:{margin:"8px",width:"auto",alignItems:"center"},ButtonsOrder:{width:"100%"},panelTotal:{backgroundColor:"rgb(9 202 0 / 12%)",opacity:"unset !important"},root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(18),flexBasis:"90%",flexShrink:0,fontWeight:500,marginLeft:"8px"},headingTotal:{fontSize:e.typography.pxToRem(18),fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}}))((function(e){var t=e.history,n=(e.id,Object(E.useState)(!1)),a=h()(n,2),o=a[0],l=a[1],u=Object(E.useState)([]),m=h()(u,2),d=(m[0],m[1],Object(E.useState)({})),b=h()(d,2),y=b[0],v=b[1],w=Object(E.useState)("items"),j=h()(w,2),k=j[0],z=j[1],B=Object(E.useState)(null),R=h()(B,2),U=R[0],K=R[1],Q=Object(E.useState)(null),V=h()(Q,2),Y=V[0],Z=V[1],ee=Object(E.useState)([]),te=h()(ee,2),ne=te[0],ae=te[1],re=Object(E.useState)({total_bruto:0,total:0,delivery_cost:"",discount:"",payment_method:""}),oe=h()(re,2),ce=oe[0],le=oe[1],ie=function(){var e=f()(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,S.d.show(t);case 4:return n=e.sent,le(n.data),ae(n.data.details),e.next=9,S.a.show(n.data.id_customer);case 9:a=e.sent,Z(a),l(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),l(!1);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();Object(E.useEffect)((function(){if(!(Object.keys(ne).length>0)){var t=e.match.params,n=e.location;D.a(n.search);K(t.id),ie(t.id)}}),[]),Object(E.useEffect)((function(){Y&&(0==ne.length?ue(!1):ue())}),[ce.total_bruto]),Object(E.useEffect)((function(){Y&&ue(!1)}),[ce.discount]),Object(E.useEffect)((function(){"ef"==ce.payment_method&&"p"==Y.type&&le((function(e){return X({},e,{discount:10})}))}),[ce.payment_method]);var ue=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log(ce.total_bruto);var t=ce.total_bruto,n=ce.delivery_cost;parseFloat(ce.discount)&&(t-=ce.discount*t/100),e&&(n=t<1500&&"p"==Y.type?150:0,t+=n),t!=ce.total&&le((function(e){return X({},e,{total:Number(t.toFixed(2)),delivery_cost:n})}))},se=function(e){return function(t,n){Y?z(!!n&&e):v({type:"error",body:"Debe elegir un cliente primero",closed:function(){return v({})}})}},me=function(e){Z(e),z("items")},pe=function(e,t){le((function(n){return X({},n,s()({},e.name,"number"==t?Number(e.value):e.value))}))},de=e.classes,fe=i()(e,["classes"]),be=function(){var e=f()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ne[t].id,e.next=3,S.e.delete(n);case 3:e.sent,le((function(e){return X({},e,{total_bruto:Number((parseFloat(e.total_bruto)-parseFloat(ne[t].price_final)).toFixed(2))})})),v({type:"success",body:'"'+ne[t].name+'" eliminado',closed:function(){return v({})}}),ae((function(e){return e.splice(t,1),r()(e)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=f()(p.a.mark((function e(t){var n,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=X({},t)).id_order=U,e.next=4,S.e.store(n);case 4:a=e.sent,o=X({},t,{},a),ae((function(e){return e.push(o),r()(e)})),le((function(e){return X({},e,{total_bruto:Number((parseFloat(e.total_bruto)+parseFloat(a.price_final)).toFixed(2))})})),v({type:"success",body:'"'+t.name+'" agregado',closed:function(){return v({})}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=f()(p.a.mark((function e(){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,(n=X({},ce)).id_customer=Y.id,e.next=6,S.d.update(U,X({},n));case 6:a=e.sent,v({type:"success",body:'Orden "'+a.id+'" creada con éxito',closed:function(){return v({})}}),l(!1),t.push(P.a("backoffice.general.orders.index")),e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(1),console.log(e.t0),e.t0.response){e.next=17;break}throw new Error("Unknown error");case 17:r=e.t0.response.data.errors,setErrors(r),l(!1);case 20:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return g.a.createElement(F.b,c()({},fe,{pageTitle:"Nuevo Pedido # ".concat(U),tabs:[],message:y,showBreadcrumbs:!1}),g.a.createElement("div",{className:de.pageContentWrapper},o&&g.a.createElement(T.b,null),g.a.createElement(x.p,{expanded:"customer"===k,onChange:se("customer")},g.a.createElement(x.r,{expandIcon:g.a.createElement(M.a,null)},g.a.createElement($.a,null),g.a.createElement(x.lb,{className:de.heading},Y?Y.name:"Cliente")),g.a.createElement(x.q,{className:de.panelDetails},g.a.createElement(L.a,c()({},fe,{customer:Y,setCustomer:me})))),g.a.createElement(x.p,{expanded:"items"===k,onChange:se("items")},g.a.createElement(x.r,{expandIcon:g.a.createElement(M.a,null)},g.a.createElement(H.a,null),g.a.createElement(x.lb,{className:de.heading},"Productos ($",ce.total_bruto?ce.total_bruto:"0.00",")")),g.a.createElement(x.q,{className:de.panelDetails},g.a.createElement(O.a,{className:de.table},g.a.createElement(_.a,null,ne.map((function(e,t){return g.a.createElement(C.a,{key:e.id},g.a.createElement(N.a,{scope:"row",className:de.cell},e.name," ",g.a.createElement("br",null),e.quantity," x ",e.price_unit," ",g.a.createElement("br",null),e.discount," %"),g.a.createElement(N.a,{className:de.cell_subtotal},g.a.createElement(I.a,{className:de.button,"aria-label":"Delete",onClick:function(){return be(t)}},g.a.createElement(q.a,null)),g.a.createElement("b",null,"$ ",e.price_final)))})))),g.a.createElement(L.b,c()({typePrice:Y?Y.type:"m",total:ce.total,addItemsToOrder:he},fe)))),g.a.createElement(x.p,{expanded:"extras"===k,onChange:se("extras")},g.a.createElement(x.r,{expandIcon:g.a.createElement(M.a,null)},g.a.createElement(J.a,null),g.a.createElement(x.lb,{className:de.heading},"Extras (- $",ce.discount+ce.delivery_cost>0?ce.discount*ce.total_bruto/100+ce.delivery_cost:"0",")")),g.a.createElement(x.q,{className:de.panelDetailsRow},g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{shrink:!0,htmlFor:"payment_method"},"Método de pago"),g.a.createElement(x.M,{onChange:function(e){return pe(e.target,"text")},className:de.selectNative,value:ce.payment_method,input:g.a.createElement(x.z,{name:"payment_method"})},g.a.createElement("option",{value:""},"No definido"),g.a.createElement("option",{value:"ef"},"Efectivo"),g.a.createElement("option",{value:"trans"},"Transferencia"),g.a.createElement("option",{value:"mp"},"Mercado Pago"))),g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{htmlFor:"discount"},"Descuento %"," ",g.a.createElement("span",null)),g.a.createElement(x.z,{name:"discount",type:"number",min:1,step:1,max:100,value:ce.discount,onChange:function(e){return pe(e.target,"number")},fullWidth:!0})),g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{htmlFor:"delivery_cost"},"Costo de envío",g.a.createElement("span",null)),g.a.createElement(x.z,{name:"delivery_cost",type:"number",value:ce.delivery_cost,onChange:function(e){return t=e.target,le((function(e){return X({},e,s()({},t.name,Number(t.value)))})),void ue(!1);var t},fullWidth:!0})))),g.a.createElement(x.p,{expanded:"comments"===k,onChange:se("comments")},g.a.createElement(x.r,{expandIcon:g.a.createElement(M.a,null)},g.a.createElement(A.a,null),g.a.createElement(x.lb,{className:de.heading},"Notas del pedido")),g.a.createElement(x.q,{className:de.panelDetails},g.a.createElement(x.u,{item:!0,xs:12,sm:12},g.a.createElement(x.ib,{name:"notes",onChange:function(e){return pe(e.target,"text")},label:"Notas",multiline:!0,fullWidth:!0,variant:"outlined",rowsMax:8})))),g.a.createElement(x.p,{disabled:!0,className:de.panelTotal},g.a.createElement(x.r,{className:de.panelTotal},g.a.createElement(G.a,null),g.a.createElement(x.lb,{className:de.headingTotal},"Total pedido: $",ce.total))),g.a.createElement(x.u,{container:!0,className:de.gridButtonsFooter,spacing:24},g.a.createElement(x.u,{item:!0,xs:12},g.a.createElement(W.a,{className:de.ButtonsOrder,variant:"contained",color:"primary",disabled:!(ce.total>0),onClick:function(){return Ee()}},"Guardar")))))}))}}]);