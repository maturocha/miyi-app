(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{938:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l}));var a=n(22),r=Object(a.a)((function(){return n.e(6).then(n.bind(null,940))})),o=Object(a.a)((function(){return Promise.all([n.e(1),n.e(7)]).then(n.bind(null,941))})),c=Object(a.a)((function(){return n.e(38).then(n.bind(null,942))})),l=Object(a.a)((function(){return Promise.all([n.e(0),n.e(22)]).then(n.bind(null,943))}))},959:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(22),r=(Object(a.a)((function(){return Promise.all([n.e(0),n.e(21)]).then(n.bind(null,965))})),Object(a.a)((function(){return Promise.all([n.e(0),n.e(39)]).then(n.bind(null,966))}))),o=Object(a.a)((function(){return Promise.all([n.e(0),n.e(40)]).then(n.bind(null,967))}))},981:function(e,t,n){"use strict";n.r(t);var a=n(46),r=n.n(a),o=n(4),c=n.n(o),l=n(5),u=n.n(l),i=n(9),s=n.n(i),m=n(35),p=n.n(m),d=n(54),f=n.n(d),b=n(31),E=n.n(b),h=n(0),g=n.n(h),x=n(21),y=n(28),v=n(206),O=n.n(v),w=n(207),N=n.n(w),j=n(149),_=n.n(j),k=n(209),C=n.n(k),D=n(105),P=n(944),S=n(203),T=n(938),F=n(58),z=n.n(F),W=n(50),q=n.n(W),B=n(873),I=n.n(B),R=n(893),M=n(894),$=n(895),H=n(896),J=n(897),A=n(898),G=n(959);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=Object(y.withStyles)((function(e){var t;return{pageContentWrapper:{width:"100%",marginTop:3*e.spacing.unit,minHeight:"75vh",overflowX:"auto"},table:{margin:"8px 0"},cell:{padding:"8px 4px"},cell_subtotal:{padding:"8px 4px !important",display:"flex",flexDirection:"column",textAlign:"center",fontSize:e.typography.pxToRem(14)},pageContent:{padding:3*e.spacing.unit},panelDetails:{flexDirection:"column",padding:"8px 4px"},panelDetailsRow:(t={flexDirection:"column"},s()(t,e.breakpoints.up("md"),{flexDirection:"row"}),s()(t,"padding","8px 4px"),t),selectNative:{display:"block"},gridButtonsFooter:{margin:"8px",width:"auto",alignItems:"center"},ButtonsOrder:{width:"100%"},panelTotal:{backgroundColor:"rgb(9 202 0 / 12%)",opacity:"unset !important"},root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(18),flexBasis:"90%",flexShrink:0,fontWeight:500,marginLeft:"8px"},headingTotal:{fontSize:e.typography.pxToRem(18),fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}}))((function(e){var t=e.history,n=Object(h.useState)(!1),a=E()(n,2),o=a[0],l=a[1],i=Object(h.useState)([]),m=E()(i,2),d=(m[0],m[1],Object(h.useState)({})),b=E()(d,2),y=b[0],v=b[1],w=Object(h.useState)("customer"),j=E()(w,2),k=j[0],F=j[1],W=Object(h.useState)(null),B=E()(W,2),L=B[0],X=B[1],K=Object(h.useState)(null),Q=E()(K,2),V=Q[0],Y=Q[1],Z=Object(h.useState)([]),ee=E()(Z,2),te=ee[0],ne=ee[1],ae=Object(h.useState)({total_bruto:0,total:0,delivery_cost:"",discount:"",payment_method:""}),re=E()(ae,2),oe=re[0],ce=re[1],le=function(){var e=f()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,P.d.store({});case 4:t=e.sent,X(t.id),l(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),l(!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(h.useEffect)((function(){le()}),[]),Object(h.useEffect)((function(){V&&(0==te.length?ue(!1):ue())}),[oe.total_bruto]),Object(h.useEffect)((function(){V&&ue(!1)}),[oe.discount]),Object(h.useEffect)((function(){"ef"==oe.payment_method&&"p"==V.type&&ce((function(e){return U({},e,{discount:10})}))}),[oe.payment_method]);var ue=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=oe.total_bruto,n=oe.delivery_cost;parseFloat(oe.discount)&&(t-=oe.discount*t/100),e&&(n=t<1500&&"p"==V.type?150:0,t+=n),t!=oe.total&&ce((function(e){return U({},e,{total:Number(t.toFixed(2)),delivery_cost:n})}))},ie=function(e){return function(t,n){V?F(!!n&&e):v({type:"error",body:"Debe elegir un cliente primero",closed:function(){return v({})}})}},se=function(e){Y(e),F("items")},me=function(e,t){ce((function(n){return U({},n,s()({},e.name,"number"==t?Number(e.value):e.value))}))},pe=e.classes,de=u()(e,["classes"]),fe=function(){var e=f()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=te[t].id,e.next=3,P.e.delete(n);case 3:e.sent,ce((function(e){return U({},e,{total_bruto:Number((parseFloat(e.total_bruto)-parseFloat(te[t].price_final)).toFixed(2))})})),v({type:"success",body:'"'+te[t].name+'" eliminado',closed:function(){return v({})}}),ne((function(e){return e.splice(t,1),r()(e)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=f()(p.a.mark((function e(t){var n,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=U({},t)).id_order=L,e.next=4,P.e.store(n);case 4:a=e.sent,o=U({},t,{},a),ne((function(e){return e.push(o),r()(e)})),ce((function(e){return U({},e,{total_bruto:Number((parseFloat(e.total_bruto)+parseFloat(a.price_final)).toFixed(2))})})),v({type:"success",body:'"'+t.name+'" agregado',closed:function(){return v({})}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=f()(p.a.mark((function e(){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,(n=U({},oe)).id_customer=V.id,e.next=6,P.d.update(L,U({},n));case 6:a=e.sent,v({type:"success",body:'Orden "'+a.id+'" creada con éxito',closed:function(){return v({})}}),l(!1),t.push(D.a("backoffice.general.orders.index")),e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(1),console.log(e.t0),e.t0.response){e.next=17;break}throw new Error("Unknown error");case 17:r=e.t0.response.data.errors,setErrors(r),l(!1);case 20:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();return g.a.createElement(T.b,c()({},de,{pageTitle:"Nuevo Pedido # ".concat(L),tabs:[],message:y,showBreadcrumbs:!1}),g.a.createElement("div",{className:pe.pageContentWrapper},o&&g.a.createElement(S.b,null),g.a.createElement(x.p,{expanded:"customer"===k,onChange:ie("customer")},g.a.createElement(x.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(M.a,null),g.a.createElement(x.lb,{className:pe.heading},V?V.name:"Cliente")),g.a.createElement(x.q,{className:pe.panelDetails},g.a.createElement(G.a,c()({},de,{customer:V,setCustomer:se})))),g.a.createElement(x.p,{expanded:"items"===k,onChange:ie("items")},g.a.createElement(x.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement($.a,null),g.a.createElement(x.lb,{className:pe.heading},"Productos ($",oe.total_bruto?oe.total_bruto:"0.00",")")),g.a.createElement(x.q,{className:pe.panelDetails},g.a.createElement(O.a,{className:pe.table},g.a.createElement(N.a,null,te.map((function(e,t){return g.a.createElement(C.a,{key:e.quantity},g.a.createElement(_.a,{scope:"row",className:pe.cell},e.name," ",g.a.createElement("br",null),e.quantity," x ",e.price_unit," ",g.a.createElement("br",null),e.discount," %"),g.a.createElement(_.a,{className:pe.cell_subtotal},g.a.createElement(q.a,{className:pe.button,"aria-label":"Delete",onClick:function(){return fe(t)}},g.a.createElement(I.a,null)),g.a.createElement("b",null,"$ ",e.price_final)))})))),g.a.createElement(G.b,c()({typePrice:V?V.type:"m",total:oe.total,addItemsToOrder:be},de)))),g.a.createElement(x.p,{expanded:"extras"===k,onChange:ie("extras")},g.a.createElement(x.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(H.a,null),g.a.createElement(x.lb,{className:pe.heading},"Extras")),g.a.createElement(x.q,{className:pe.panelDetailsRow},g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{shrink:!0,htmlFor:"payment_method"},"Método de pago"),g.a.createElement(x.M,{onChange:function(e){return me(e.target,"text")},className:pe.selectNative,value:oe.payment_method,input:g.a.createElement(x.z,{name:"payment_method"})},g.a.createElement("option",{value:""},"No definido"),g.a.createElement("option",{value:"ef"},"Efectivo"),g.a.createElement("option",{value:"trans"},"Transferencia"),g.a.createElement("option",{value:"mp"},"Mercado Pago"))),g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{htmlFor:"discount"},"Descuento %"," ",g.a.createElement("span",null)),g.a.createElement(x.z,{name:"discount",type:"number",min:1,step:1,max:100,value:oe.discount,onChange:function(e){return me(e.target,"number")},fullWidth:!0})),g.a.createElement(x.u,{item:!0,xs:12,sm:4},g.a.createElement(x.C,{htmlFor:"delivery_cost"},"Costo de envío",g.a.createElement("span",null)),g.a.createElement(x.z,{name:"delivery_cost",type:"number",value:oe.delivery_cost,onChange:function(e){return t=e.target,ce((function(e){return U({},e,s()({},t.name,Number(t.value)))})),void ue(!1);var t},fullWidth:!0})))),g.a.createElement(x.p,{expanded:"comments"===k,onChange:ie("comments")},g.a.createElement(x.r,{expandIcon:g.a.createElement(R.a,null)},g.a.createElement(J.a,null),g.a.createElement(x.lb,{className:pe.heading},"Notas del pedido")),g.a.createElement(x.q,{className:pe.panelDetails},g.a.createElement(x.u,{item:!0,xs:12,sm:12},g.a.createElement(x.ib,{name:"notes",onChange:function(e){return me(e.target,"text")},label:"Notas",multiline:!0,fullWidth:!0,variant:"outlined",rowsMax:8})))),g.a.createElement(x.p,{disabled:!0,className:pe.panelTotal},g.a.createElement(x.r,{className:pe.panelTotal},g.a.createElement(A.a,null),g.a.createElement(x.lb,{className:pe.headingTotal},"Total pedido: $",oe.total))),g.a.createElement(x.u,{container:!0,className:pe.gridButtonsFooter,spacing:24},g.a.createElement(x.u,{item:!0,xs:12},g.a.createElement(z.a,{className:pe.ButtonsOrder,variant:"contained",color:"primary",disabled:!(oe.total>0),onClick:function(){return Ee()}},"Guardar")))))}))}}]);