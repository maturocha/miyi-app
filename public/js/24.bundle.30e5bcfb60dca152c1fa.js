(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{961:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(22),r=(Object(a.a)((function(){return Promise.all([n.e(0),n.e(13)]).then(n.bind(null,967))})),Object(a.a)((function(){return Promise.all([n.e(0),n.e(38)]).then(n.bind(null,968))}))),o=Object(a.a)((function(){return Promise.all([n.e(0),n.e(39)]).then(n.bind(null,969))}))},984:function(e,t,n){"use strict";n.r(t);var a=n(47),r=n.n(a),o=n(4),c=n.n(o),l=n(5),i=n.n(l),s=n(9),u=n.n(s),m=n(35),p=n.n(m),d=n(54),f=n.n(d),b=n(31),E=n.n(b),h=n(0),g=n.n(h),v=n(21),x=n(28),y=n(206),w=n.n(y),O=n(207),_=n.n(O),N=n(149),j=n.n(N),k=n(209),D=n.n(k),C=n(61),S=n(106),P=n(942),T=n(203),F=n(941),R=n(58),W=n.n(R),B=n(50),I=n.n(B),q=n(875),z=n.n(q),A=n(895),$=n(896),M=n(897),H=n(898),J=n(899),G=n(900),L=n(961);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=Object(x.withStyles)((function(e){var t;return{pageContentWrapper:{width:"100%",marginTop:3*e.spacing.unit,minHeight:"75vh",overflowX:"auto"},table:{margin:"8px 0"},cell:{padding:"8px 4px"},cell_subtotal:{padding:"8px 4px !important",display:"flex",flexDirection:"column",textAlign:"center",fontSize:e.typography.pxToRem(14)},pageContent:{padding:3*e.spacing.unit},panelDetails:{flexDirection:"column",padding:"8px 4px"},panelDetailsRow:(t={flexDirection:"column"},u()(t,e.breakpoints.up("md"),{flexDirection:"row"}),u()(t,"padding","8px 4px"),t),selectNative:{display:"block"},gridButtonsFooter:{margin:"8px",width:"auto",alignItems:"center"},ButtonsOrder:{width:"100%"},panelTotal:{backgroundColor:"rgb(9 202 0 / 12%)",opacity:"unset !important"},root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(18),flexBasis:"90%",flexShrink:0,fontWeight:500,marginLeft:"8px"},headingTotal:{fontSize:e.typography.pxToRem(18),fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}}))((function(e){var t=e.history,n=(e.id,Object(h.useState)(!1)),a=E()(n,2),o=a[0],l=a[1],s=Object(h.useState)([]),m=E()(s,2),d=(m[0],m[1],Object(h.useState)({})),b=E()(d,2),x=b[0],y=b[1],O=Object(h.useState)("items"),N=E()(O,2),k=N[0],R=N[1],B=Object(h.useState)(null),q=E()(B,2),U=q[0],K=q[1],Q=Object(h.useState)(null),V=E()(Q,2),Y=V[0],Z=V[1],ee=Object(h.useState)([]),te=E()(ee,2),ne=te[0],ae=te[1],re=Object(h.useState)({total_bruto:0,total:0,delivery_cost:0,discount:0,payment_method:""}),oe=E()(re,2),ce=oe[0],le=oe[1],ie=Object(h.useRef)(!1),se=function(){var e=f()(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,P.d.show(t);case 4:return n=e.sent,le(n.data),ae(n.data.details),e.next=9,P.a.show(n.data.id_customer);case 9:a=e.sent,Z(a),l(!1),ie.current=!0,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),l(!1);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}();Object(h.useEffect)((function(){if(!(Object.keys(ne).length>0)){var t=e.match.params,n=e.location;C.a(n.search);K(t.id),se(t.id)}}),[]),Object(h.useEffect)((function(){ie.current&&ge()}),[ce.total]),Object(h.useEffect)((function(){ie.current&&(0==ne.length?ue(!1):ue())}),[ce.total_bruto]),Object(h.useEffect)((function(){ie.current&&ue(!1)}),[ce.discount]),Object(h.useEffect)((function(){ie.current&&"ef"==ce.payment_method&&"p"==Y.type&&le((function(e){return X({},e,{discount:10})}))}),[ce.payment_method]);var ue=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log(ce.total_bruto);var t=ce.total_bruto,n=ce.delivery_cost;parseFloat(ce.discount)&&(t-=ce.discount*t/100),e&&(n=t<1500&&"p"==Y.type?150:0,t+=n),t!=ce.total&&le((function(e){return X({},e,{total:Number(t.toFixed(2)),delivery_cost:n})}))},me=function(e){return function(t,n){Y?R(!!n&&e):y({type:"error",body:"Debe elegir un cliente primero",closed:function(){return y({})}})}},pe=function(e){Z(e),R("items")},de=function(e,t){le((function(n){return X({},n,u()({},e.name,"number"==t?Number(e.value):e.value))}))},fe=e.classes,be=i()(e,["classes"]),Ee=function(){var e=f()(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ne[t].id,e.next=3,P.e.delete(n);case 3:e.sent,le((function(e){return X({},e,{total_bruto:Number((parseFloat(e.total_bruto)-parseFloat(ne[t].price_final)).toFixed(2))})})),y({type:"success",body:'"'+ne[t].name+'" eliminado',closed:function(){return y({})}}),ae((function(e){return e.splice(t,1),r()(e)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=f()(p.a.mark((function e(t){var n,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=X({},t)).id_order=U,e.next=4,P.e.store(n);case 4:a=e.sent,o=X({},t,{},a),ae((function(e){return e.push(o),r()(e)})),le((function(e){return X({},e,{total_bruto:Number((parseFloat(e.total_bruto)+parseFloat(a.price_final)).toFixed(2))})})),y({type:"success",body:'"'+t.name+'" agregado',closed:function(){return y({})}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=f()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=X({},ce)).id_customer=Y.id,e.next=4,P.d.update(U,X({},t));case 4:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=f()(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.prev=1,e.next=4,ge();case 4:e.sent,l(!1),t.push(S.a("backoffice.general.orders.index")),e.next=17;break;case 9:if(e.prev=9,e.t0=e.catch(1),console.log(e.t0),e.t0.response){e.next=14;break}throw new Error("Unknown error");case 14:n=e.t0.response.data.errors,setErrors(n),l(!1);case 17:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return g.a.createElement(F.b,c()({},be,{pageTitle:"Nuevo Pedido # ".concat(U),tabs:[],message:x,showBreadcrumbs:!1}),g.a.createElement("div",{className:fe.pageContentWrapper},o&&g.a.createElement(T.b,null),g.a.createElement(v.p,{expanded:"customer"===k,onChange:me("customer")},g.a.createElement(v.r,{expandIcon:g.a.createElement(A.a,null)},g.a.createElement($.a,null),g.a.createElement(v.mb,{className:fe.heading},Y?Y.name:"Cliente")),g.a.createElement(v.q,{className:fe.panelDetails},g.a.createElement(L.a,c()({},be,{customer:Y,setCustomer:pe})))),g.a.createElement(v.p,{expanded:"items"===k,onChange:me("items")},g.a.createElement(v.r,{expandIcon:g.a.createElement(A.a,null)},g.a.createElement(M.a,null),g.a.createElement(v.mb,{className:fe.heading},"Productos ($",ce.total_bruto?ce.total_bruto:"0.00",")")),g.a.createElement(v.q,{className:fe.panelDetails},g.a.createElement(w.a,{className:fe.table},g.a.createElement(_.a,null,ne.map((function(e,t){return g.a.createElement(D.a,{key:e.id},g.a.createElement(j.a,{scope:"row",className:fe.cell},e.name," ",g.a.createElement("br",null),e.quantity," x ",e.price_unit," ",g.a.createElement("br",null),e.discount," %"),g.a.createElement(j.a,{className:fe.cell_subtotal},g.a.createElement(I.a,{className:fe.button,"aria-label":"Delete",onClick:function(){return Ee(t)}},g.a.createElement(z.a,null)),g.a.createElement("b",null,"$ ",e.price_final)))})))),g.a.createElement(L.b,c()({typePrice:Y?Y.type:"m",total:ce.total,addItemsToOrder:he},be)))),g.a.createElement(v.p,{expanded:"extras"===k,onChange:me("extras")},g.a.createElement(v.r,{expandIcon:g.a.createElement(A.a,null)},g.a.createElement(H.a,null),g.a.createElement(v.mb,{className:fe.heading},"Extras (- $",ce.discount+ce.delivery_cost>0?ce.discount*ce.total_bruto/100+ce.delivery_cost:"0",")")),g.a.createElement(v.q,{className:fe.panelDetailsRow},g.a.createElement(v.v,{item:!0,xs:12,sm:4},g.a.createElement(v.D,{shrink:!0,htmlFor:"payment_method"},"Método de pago"),g.a.createElement(v.N,{onChange:function(e){return de(e.target,"text")},className:fe.selectNative,value:ce.payment_method,input:g.a.createElement(v.A,{name:"payment_method"})},g.a.createElement("option",{value:""},"No definido"),g.a.createElement("option",{value:"ef"},"Efectivo"),g.a.createElement("option",{value:"trans"},"Transferencia"),g.a.createElement("option",{value:"mp"},"Mercado Pago"))),g.a.createElement(v.v,{item:!0,xs:12,sm:4},g.a.createElement(v.D,{htmlFor:"discount"},"Descuento %"," ",g.a.createElement("span",null)),g.a.createElement(v.A,{name:"discount",type:"number",min:1,step:1,max:100,value:ce.discount,onChange:function(e){return de(e.target,"number")},fullWidth:!0})),g.a.createElement(v.v,{item:!0,xs:12,sm:4},g.a.createElement(v.D,{htmlFor:"delivery_cost"},"Costo de envío",g.a.createElement("span",null)),g.a.createElement(v.A,{name:"delivery_cost",type:"number",value:ce.delivery_cost,onChange:function(e){return t=e.target,le((function(e){return X({},e,u()({},t.name,Number(t.value)))})),void ue(!1);var t},fullWidth:!0})))),g.a.createElement(v.p,{expanded:"comments"===k,onChange:me("comments")},g.a.createElement(v.r,{expandIcon:g.a.createElement(A.a,null)},g.a.createElement(J.a,null),g.a.createElement(v.mb,{className:fe.heading},"Notas del pedido")),g.a.createElement(v.q,{className:fe.panelDetails},g.a.createElement(v.v,{item:!0,xs:12,sm:12},g.a.createElement(v.jb,{name:"notes",onChange:function(e){return de(e.target,"text")},label:"Notas",multiline:!0,fullWidth:!0,variant:"outlined",rowsMax:8})))),g.a.createElement(v.p,{disabled:!0,className:fe.panelTotal},g.a.createElement(v.r,{className:fe.panelTotal},g.a.createElement(G.a,null),g.a.createElement(v.mb,{className:fe.headingTotal},"Total pedido: $",ce.total))),g.a.createElement(v.v,{container:!0,className:fe.gridButtonsFooter,spacing:24},g.a.createElement(v.v,{item:!0,xs:12},g.a.createElement(W.a,{className:fe.ButtonsOrder,variant:"contained",color:"primary",disabled:!(ce.total>0),onClick:function(){return ve()}},"Guardar")))))}))}}]);